version: '3'
services:
  app:
    build: .
    image: keboola/generic-extractor

  ci: &ci
    build:
      context: .
      dockerfile: Dockerfile-tests
    command: composer ci
    depends_on:
      - jsontest

  dev:
    << : *ci
    command: bash
    volumes:
      - ./:/code
      - ./data:/data

  jsontest:
      build: ./docker/jsontest
      image: keboola/jsontest
